"use strict";(self.webpackChunkrx_angular=self.webpackChunkrx_angular||[]).push([[4598],{4510:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>s,metadata:()=>p,toc:()=>m});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),o=["components"],s={sidebar_position:2,title:"Manage entities using @ngrx/entity"},l=void 0,p={unversionedId:"state/integrations/manage-entities-using-ngrx-entity",id:"state/integrations/manage-entities-using-ngrx-entity",title:"Manage entities using @ngrx/entity",description:"Author: @Phhansen",source:"@site/docs/state/integrations/manage-entities-using-ngrx-entity.md",sourceDirName:"state/integrations",slug:"/state/integrations/manage-entities-using-ngrx-entity",permalink:"/docs/state/integrations/manage-entities-using-ngrx-entity",draft:!1,editUrl:"https://github.com/rx-angular/rx-angular/edit/main/docs/state/integrations/manage-entities-using-ngrx-entity.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"Manage entities using @ngrx/entity"},sidebar:"docs",previous:{title:"Reuse ngrx selectors to compose state",permalink:"/docs/state/integrations/resuse-ngrx-selectors-to-compose-state"}},c={},m=[{value:"Using <code>@ngrx/entity</code>",id:"using-ngrxentity",level:2},{value:"Selecting state with <code>@ngrx/entity</code>",id:"selecting-state-with-ngrxentity",level:2}],u={toc:m};function d(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Author: ",(0,i.kt)("a",{parentName:"em",href:"https://github.com/Phhansen"},"@Phhansen"))),(0,i.kt)("h1",{id:"manage-entities-using-ngrxentity"},"Manage entities using ",(0,i.kt)("inlineCode",{parentName:"h1"},"@ngrx/entity")),(0,i.kt)("p",null,"When working with collections or arrays in our state, we tend to write many repeated code when we want to add, update or delete items from these collections."),(0,i.kt)("p",null,"In NgRx, they have created a helper library called ",(0,i.kt)("a",{parentName:"p",href:"https://ngrx.io/guide/entity/adapter"},"@ngrx/entity adapter"),". The adapter provides a simple API to manipulate and query these collections, hiding much repetitive code needed."),(0,i.kt)("p",null,"Let's say we have a collection of type ",(0,i.kt)("inlineCode",{parentName:"p"},"Item")," as part of our component state;"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"interface Item {\n  id: string;\n  name: string;\n}\n\ninterface ComponentState {\n  items: Item[];\n  loading: boolean;\n}\n")),(0,i.kt)("p",null,"Now, if we want to add one item to our array ",(0,i.kt)("em",{parentName:"p"},"(in an immutable way)"),", we replace the ",(0,i.kt)("inlineCode",{parentName:"p"},"items")," array in the state with a new reference."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"@Component({\n  selector: 'my-component',\n})\nexport class MyComponent extends RxState<ComponentState> {\n  readonly addItem$ = new Subject<string>();\n\n  constructor() {\n    super();\n\n    this.connect(this.addItem$, (oldState, itemName) => {\n      const newItem = {\n        id: uuid(), // unique hash generation fn()\n        name: itemName,\n      };\n\n      return {\n        ...oldState,\n        items: [...oldState.items, newItem],\n      };\n    });\n  }\n}\n")),(0,i.kt)("p",null,"If we want to update one item, we have to query the ",(0,i.kt)("inlineCode",{parentName:"p"},"items")," array first to get a hold of the item and then construct a new array again."),(0,i.kt)("p",null,"What about deleting an item? You get the picture. ",(0,i.kt)("strong",{parentName:"p"},"It\xb4s a lot of code"),", and it will grow even more if we have several types of collections in our state."),(0,i.kt)("h2",{id:"using-ngrxentity"},"Using ",(0,i.kt)("inlineCode",{parentName:"h2"},"@ngrx/entity")),(0,i.kt)("p",null,"Now let us see how our code will look when using ",(0,i.kt)("inlineCode",{parentName:"p"},"@ngrx/entity"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"interface Item {\n  id: string;\n  name: string;\n}\n\ninterface ComponentState extends EntityState<Item> {\n  loading: boolean;\n}\n\nconst adapter: EntityAdapter<Item> = createEntityAdapter<Item>({\n  selectId: (item: Item) => item.id,\n});\n")),(0,i.kt)("p",null,"The entity adapter needs a ",(0,i.kt)("inlineCode",{parentName:"p"},"selectId")," function which is used to query items by ",(0,i.kt)("inlineCode",{parentName:"p"},"id")," within the collection."),(0,i.kt)("p",null,"Now let's see how the component has changed:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"@Component({\n  selector: 'my-component',\n})\nexport class MyComponent extends RxState<ComponentState> {\n  readonly addItem$ = new Subject<string>();\n\n  constructor() {\n    super();\n\n    this.connect(this.addItem$, (oldState, itemName) =>\n      adapter.addOne({ id: uuid(), name: itemName() }, oldState)\n    );\n  }\n}\n")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"addOne()")," function is just one of many functions that help us manipulate the collection."),(0,i.kt)("p",null,"Delete an item? ",(0,i.kt)("inlineCode",{parentName:"p"},"removeOne(item.id, oldState)"),"."),(0,i.kt)("p",null,"Check out the ",(0,i.kt)("a",{parentName:"p",href:"https://ngrx.io/guide/entity/adapter#adapter-collection-methods"},"full list of adapter collection methods")),(0,i.kt)("h2",{id:"selecting-state-with-ngrxentity"},"Selecting state with ",(0,i.kt)("inlineCode",{parentName:"h2"},"@ngrx/entity")),(0,i.kt)("p",null,"The entity adapter comes with a small set of default selectors we can use right out of the box."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"import { select } from '@ngrx/store';\n\nconst { selectIds, selectEntities, selectAll, selectTotal } =\n  adapter.getSelectors();\n\n@Component({\n  selector: 'my-component',\n})\nexport class MyComponent extends RxState<ComponentState> {\n  readonly items$ = this.select(select(selectAll));\n\n  constructor() {\n    super();\n  }\n}\n")))}d.isMDXComponent=!0},3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>d});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(n),d=r,g=u["".concat(l,".").concat(d)]||u[d]||m[d]||i;return n?a.createElement(g,o(o({ref:t},c),{},{components:n})):a.createElement(g,o({ref:t},c))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);